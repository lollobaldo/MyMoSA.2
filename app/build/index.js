!function(e){var t={},n={0:0};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(t){if(0!==n[t]){var o=require("./"+({}[t]||t)),r=o.modules,s=o.ids;for(var c in r)e[c]=r[c];for(var u=0;u<s.length;u++)n[s[u]]=0}return Promise.all([])},o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){process.nextTick((function(){throw e}))},o(o.s=7)}([function(e,t){e.exports=require("os")},function(e,t){e.exports=require("node-dht-sensor")},,,,function(e,t){e.exports=require("mqtt")},function(e,t,n){var o={"./dht.js":[2,4],"./os.js":[3,5],"./template.js":[4,6]};function r(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(o)},r.id=6,e.exports=r},function(e,t,n){"use strict";n.r(t);var o=n(5);const r=e=>{console.error(e)},s=e=>{console.warn(e)},c=e=>{console.log(e)};const u={global:{modules:{template:{prettyName:"Template module",config:{interval:2e3,pin:600}}}},development:{debugging:!0},production:{debugging:!1}};var i=Object.assign(u.global,{mqttCredentials:{clientId:"MyMoSA.2",server:"mqtts://mqtt.flespi.io",username:"6tQ4BNROJgrjDzruUJQi9cr9CAbvfrJ9Ip390IOAM5JgtYybxfhwhxtJXu20JAZh",port:8883}},u.production);const{server:a,...l}=i.mqttCredentials,f=Object.assign({},i.modules),p=()=>{},d={setup:p,onMessage:p,cleanup:p},m=Object(o.connect)(a,l),g=(e,t,n,o)=>{const r=e+(t?"/":"");console.log(r),console.log(n),m.publish(r,n,o)};m.on("connect",()=>{c("Connected to MQTT broker"),(async()=>{Object.keys(f).forEach(async e=>{const t=f[e];t.name=e;try{const{setup:e,onMessage:o,cleanup:r}=Object.assign(d,await n(6)("./"+t.name+".js"));c(`Loaded module: ${t.prettyName}.`),e({publishFunction:g.bind(null,t.name),...t.config}),c(`Setup module: ${t.prettyName}.`),f[t.name].loaded=!0,f[t.name].callbacks={setup:e,onMessage:o,cleanup:r}}catch(e){s(`Failed to load module: ${t.prettyName}.`),s(e)}})})().then(()=>{Object.keys(f).forEach(e=>{const t=f[e];m.subscribe(t.name,e=>{e&&r(e)})})}).catch(e=>{console.log(e),console.log("Error setting up modules. Likely more error output is shown above")})}),m.on("message",(e,t)=>{console.log(`New message on topic ${e}: ${t.toString()}`)}),process.on("exit",e=>{c(`Whoa! Exit code ${e}, cleaning up...`),f.forEach(e=>{e.cleanup()})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwib3NcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJub2RlLWRodC1zZW5zb3JcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtcXR0XCIiLCJ3ZWJwYWNrOi8vLy4vYXBwL3NyYy9tb2R1bGVzIGxhenkgXlxcLlxcLy4qXFwuanMkIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vLy4vYXBwL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvc3JjL2NvbmZpZy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvc3JjL2NvbmZpZy9jcmVkZW50aWFscy5qcyIsIndlYnBhY2s6Ly8vLi9hcHAvc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJpbnN0YWxsZWRDaHVua3MiLCIwIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJlIiwiY2h1bmtJZCIsImNodW5rIiwicmVxdWlyZSIsIm1vcmVNb2R1bGVzIiwiY2h1bmtJZHMiLCJpZHMiLCJsZW5ndGgiLCJQcm9taXNlIiwiYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsIm9lIiwiZXJyIiwicHJvY2VzcyIsIm5leHRUaWNrIiwicyIsIm1hcCIsIndlYnBhY2tBc3luY0NvbnRleHQiLCJyZXEiLCJyZXNvbHZlIiwidGhlbiIsIkVycm9yIiwiY29kZSIsImlkIiwia2V5cyIsImxvZ2dlciIsIm1zZyIsImNvbnNvbGUiLCJlcnJvciIsIndhcm4iLCJsb2ciLCJjb25maWciLCJnbG9iYWwiLCJ0ZW1wbGF0ZSIsInByZXR0eU5hbWUiLCJpbnRlcnZhbCIsInBpbiIsImRldmVsb3BtZW50IiwiZGVidWdnaW5nIiwicHJvZHVjdGlvbiIsImFzc2lnbiIsIm1xdHRDcmVkZW50aWFscyIsImNsaWVudElkIiwic2VydmVyIiwidXNlcm5hbWUiLCJwb3J0IiwidHJpdmlhbEZ1bmN0aW9uIiwiZGVmYXVsdEV4cG9ydHMiLCJzZXR1cCIsIm9uTWVzc2FnZSIsImNsZWFudXAiLCJjbGllbnQiLCJzYWZlUHVibGlzaCIsInRvcGljIiwibWVzc2FnZSIsIm9wdGlvbnMiLCJwdWJsaXNoIiwib24iLCJhc3luYyIsImZvckVhY2giLCJwdWJsaXNoRnVuY3Rpb24iLCJsb2FkZWQiLCJjYWxsYmFja3MiLCJzdGFydHVwIiwic3Vic2NyaWJlIiwiY2F0Y2giLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FJbkJDLEVBQWtCLENBQ3JCQyxFQUFHLEdBSUosU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdKLEVBQWlCSSxHQUNuQixPQUFPSixFQUFpQkksR0FBVUMsUUFHbkMsSUFBSUMsRUFBU04sRUFBaUJJLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJLFNBQXVCQyxHQU85QyxHQUFnQyxJQUE3QlgsRUFBZ0JXLEdBQWdCLENBQ2xDLElBQUlDLEVBQVFDLFFBQVEsTUFBUSxHQUFHRixJQUFVQSxJQUNyQ0csRUFBY0YsRUFBTUosUUFBU08sRUFBV0gsRUFBTUksSUFDbEQsSUFBSSxJQUFJYixLQUFZVyxFQUNuQk4sRUFB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QUN6QnpGLEVBQVFZLEVBQUVHLE1BQU0yRSxVQUFZLENBQUVkLFFBQU9DLFlBQVdDLFdBQ2hELE1BQU81RSxHQUNQbUQsRUFBWSwwQkFBMEJ6QyxFQUFFa0QsZUFDeENULEVBQVluRCxPQU9oQnlGLEdBQVUzQyxLQUFLLEtBQ2I5QixPQUFPa0MsS0FBS3BELEdBQVN1RixRQUFTeEUsSUFDNUIsTUFBTUgsRUFBSVosRUFBUWUsR0FDbEJnRSxFQUFPYSxVQUFVaEYsRUFBRUcsS0FBT3lCLElBQ3BCQSxHQUFLYSxFQUFhYixTQUd6QnFELE1BQU8zRixJQUNScUQsUUFBUUcsSUFBSXhELEdBQ1pxRCxRQUFRRyxJQUFJLHlFQUloQnFCLEVBQU9NLEdBQUcsVUFBVyxDQUFDSixFQUFPQyxLQUMzQjNCLFFBQVFHLElBQUksd0JBQXdCdUIsTUFBVUMsRUFBUVksZ0JBR3hEckQsUUFBUTRDLEdBQUcsT0FBU25DLElBQ2xCRyxFQUFXLG1CQUFtQkgscUJBQzlCbEQsRUFBUXVGLFFBQVMzRSxJQUNmQSxFQUFFa0UiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGNodW5rc1xuIFx0Ly8gXCIwXCIgbWVhbnMgXCJhbHJlYWR5IGxvYWRlZFwiXG4gXHR2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuIFx0XHQwOiAwXG4gXHR9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cbiBcdC8vIFRoaXMgZmlsZSBjb250YWlucyBvbmx5IHRoZSBlbnRyeSBjaHVuay5cbiBcdC8vIFRoZSBjaHVuayBsb2FkaW5nIGZ1bmN0aW9uIGZvciBhZGRpdGlvbmFsIGNodW5rc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5lID0gZnVuY3Rpb24gcmVxdWlyZUVuc3VyZShjaHVua0lkKSB7XG4gXHRcdHZhciBwcm9taXNlcyA9IFtdO1xuXG5cbiBcdFx0Ly8gcmVxdWlyZSgpIGNodW5rIGxvYWRpbmcgZm9yIGphdmFzY3JpcHRcblxuIFx0XHQvLyBcIjBcIiBpcyB0aGUgc2lnbmFsIGZvciBcImFscmVhZHkgbG9hZGVkXCJcbiBcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdICE9PSAwKSB7XG4gXHRcdFx0dmFyIGNodW5rID0gcmVxdWlyZShcIi4vXCIgKyAoe31bY2h1bmtJZF18fGNodW5rSWQpICsgXCJcIik7XG4gXHRcdFx0dmFyIG1vcmVNb2R1bGVzID0gY2h1bmsubW9kdWxlcywgY2h1bmtJZHMgPSBjaHVuay5pZHM7XG4gXHRcdFx0Zm9yKHZhciBtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjaHVua0lkcy5sZW5ndGg7IGkrKylcbiBcdFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkc1tpXV0gPSAwO1xuIFx0XHR9XG4gXHRcdHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gXHR9O1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIHVuY2F1Z2h0IGVycm9yIGhhbmRsZXIgZm9yIHdlYnBhY2sgcnVudGltZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vZSA9IGZ1bmN0aW9uKGVycikge1xuIFx0XHRwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uKCkge1xuIFx0XHRcdHRocm93IGVycjsgLy8gY2F0Y2ggdGhpcyBlcnJvciBieSB1c2luZyBpbXBvcnQoKS5jYXRjaCgpXG4gXHRcdH0pO1xuIFx0fTtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwib3NcIik7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibm9kZS1kaHQtc2Vuc29yXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1xdHRcIik7IiwidmFyIG1hcCA9IHtcblx0XCIuL2RodC5qc1wiOiBbXG5cdFx0Mixcblx0XHQ0XG5cdF0sXG5cdFwiLi9vcy5qc1wiOiBbXG5cdFx0Myxcblx0XHQ1XG5cdF0sXG5cdFwiLi90ZW1wbGF0ZS5qc1wiOiBbXG5cdFx0NCxcblx0XHQ2XG5cdF1cbn07XG5mdW5jdGlvbiB3ZWJwYWNrQXN5bmNDb250ZXh0KHJlcSkge1xuXHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1hcCwgcmVxKSkge1xuXHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdFx0ZS5jb2RlID0gJ01PRFVMRV9OT1RfRk9VTkQnO1xuXHRcdFx0dGhyb3cgZTtcblx0XHR9KTtcblx0fVxuXG5cdHZhciBpZHMgPSBtYXBbcmVxXSwgaWQgPSBpZHNbMF07XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmUoaWRzWzFdKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKGlkKTtcblx0fSk7XG59XG53ZWJwYWNrQXN5bmNDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQXN5bmNDb250ZXh0S2V5cygpIHtcblx0cmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xud2VicGFja0FzeW5jQ29udGV4dC5pZCA9IDY7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tBc3luY0NvbnRleHQ7IiwiZXhwb3J0IGNvbnN0IGNpYW8gPSAoKSA9PiB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICBjb25zdCBjYyA9IDEwO1xuICByZXR1cm4gbnVsbDtcbn07XG5cbmV4cG9ydCBjb25zdCBsb2dnZXIgPSB7XG4gIGVycm9yOiAobXNnKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihtc2cpO1xuICB9LFxuICB3YXJuOiAobXNnKSA9PiB7XG4gICAgY29uc29sZS53YXJuKG1zZyk7XG4gIH0sXG4gIGxvZzogKG1zZykgPT4ge1xuICAgIGNvbnNvbGUubG9nKG1zZyk7XG4gIH0sXG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdENsZWFudXAgPSAobW9kdWxlKSA9PiB7XG4gIGxvZ2dlci5sb2coYENsZWFuZWQgbW9kdWxlOiAke21vZHVsZS5wcmV0dHlOYW1lfWApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2lhbztcbiIsImltcG9ydCBtcXR0Q3JlZGVudGlhbHMgZnJvbSAnLi9jcmVkZW50aWFscyc7XG5cblxuY29uc3QgY29uZmlnID0ge1xuICBnbG9iYWw6IHtcbiAgICBtb2R1bGVzOiB7XG4gICAgICB0ZW1wbGF0ZToge1xuICAgICAgICBwcmV0dHlOYW1lOiAnVGVtcGxhdGUgbW9kdWxlJyxcbiAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgaW50ZXJ2YWw6IDIwMDAsXG4gICAgICAgICAgcGluOiA2MDAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgLy8gZGh0OiB7XG4gICAgICAvLyAgIHByZXR0eU5hbWU6ICdESFQnLFxuICAgICAgLy8gICBjb25maWc6IHtcbiAgICAgIC8vICAgICBkYXRhUGluOiAxNyxcbiAgICAgIC8vICAgICBwcm9iaW5nSW50ZXJ2YWw6IDMwMCxcbiAgICAgIC8vICAgICBzYXZpbmdJbnRlcnZhbDogNjAwLFxuICAgICAgLy8gICB9LFxuICAgICAgLy8gfSxcbiAgICAgIC8vIG9zOiB7XG4gICAgICAvLyAgIHByZXR0eU5hbWU6ICdTeXN0ZW0gc3RhdHMnLFxuICAgICAgLy8gICBjb25maWc6IHtcbiAgICAgIC8vICAgICBwcm9iaW5nSW50ZXJ2YWw6IDMwMCxcbiAgICAgIC8vICAgICBzYXZpbmdJbnRlcnZhbDogNjAwLFxuICAgICAgLy8gICB9LFxuICAgICAgLy8gfSxcbiAgICB9LFxuICAgIC8vIG1vZHVsZXM6IFtcbiAgICAvLyAgIHtcbiAgICAvLyAgICAgbmFtZTogJ2RodCcsXG4gICAgLy8gICAgIHByZXR0eU5hbWU6ICdESFQnLFxuICAgIC8vICAgICBjb25maWc6IHtcbiAgICAvLyAgICAgICBkYXRhUGluOiAxNyxcbiAgICAvLyAgICAgICBwcm9iaW5nSW50ZXJ2YWw6IDMwMCxcbiAgICAvLyAgICAgICBzYXZpbmdJbnRlcnZhbDogNjAwLFxuICAgIC8vICAgICB9LFxuICAgIC8vICAgfSxcbiAgICAvLyAgIHtcbiAgICAvLyAgICAgbmFtZTogJ29zJyxcbiAgICAvLyAgICAgcHJldHR5TmFtZTogJ1N5c3RlbSBzdGF0cycsXG4gICAgLy8gICAgIGNvbmZpZzoge1xuICAgIC8vICAgICAgIHByb2JpbmdJbnRlcnZhbDogMzAwLFxuICAgIC8vICAgICAgIHNhdmluZ0ludGVydmFsOiA2MDAsXG4gICAgLy8gICAgIH0sXG4gICAgLy8gICB9LFxuICAgIC8vIF0sXG4gIH0sXG4gIGRldmVsb3BtZW50OiB7XG4gICAgZGVidWdnaW5nOiB0cnVlLFxuICB9LFxuICBwcm9kdWN0aW9uOiB7XG4gICAgZGVidWdnaW5nOiBmYWxzZSxcbiAgfSxcbn07XG5cbmNvbnN0IGVudiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8ICdkZXZlbG9wbWVudCc7XG5jb25zdCBmdWxsQ29uZmlnID0gT2JqZWN0LmFzc2lnbihcbiAgY29uZmlnLmdsb2JhbCxcbiAgbXF0dENyZWRlbnRpYWxzLFxuICBjb25maWdbZW52XSxcbik7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bGxDb25maWc7XG4iLCJleHBvcnQgZGVmYXVsdCB7XG4gIG1xdHRDcmVkZW50aWFsczoge1xuICAgIGNsaWVudElkOiAnTXlNb1NBLjInLFxuICAgIHNlcnZlcjogJ21xdHRzOi8vbXF0dC5mbGVzcGkuaW8nLFxuICAgIHVzZXJuYW1lOiAnNnRRNEJOUk9KZ3JqRHpydVVKUWk5Y3I5Q0FidmZySjlJcDM5MElPQU01Smd0WXlieGZod2h4dEpYdTIwSkFaaCcsXG4gICAgcG9ydDogODg4MyxcbiAgfSxcbn07XG4vLyBcIm1xdHRDcmVkZW50aWFsc1wiOiB7XG4vLyAgIFwiY2xpZW50SWRcIjogXCJNeU1vU0FcIixcbi8vICAgXCJzZXJ2ZXJcIjogXCJtcXR0Oi8vbTIxLmNsb3VkbXF0dC5jb21cIixcbi8vICAgXCJ1c2VybmFtZVwiOiBcImJpc2F2d3FzXCIsXG4vLyAgIFwicGFzc3dvcmRcIjogXCJnc3BCbDViOFZlVHRcIixcbi8vICAgXCJwb3J0XCI6IDE2OTczXG4vLyB9XG4iLCJpbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAnbXF0dCc7XG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IGFwcENvbmZpZyBmcm9tICcuL2NvbmZpZyc7XG5cbmNvbnN0IHsgc2VydmVyLCAuLi5jcmVkZW50aWFscyB9ID0gYXBwQ29uZmlnLm1xdHRDcmVkZW50aWFscztcblxuY29uc3QgbW9kdWxlcyA9IE9iamVjdC5hc3NpZ24oe30sIGFwcENvbmZpZy5tb2R1bGVzKTtcbmNvbnN0IHRyaXZpYWxGdW5jdGlvbiA9ICgpID0+IHt9O1xuY29uc3QgZGVmYXVsdEV4cG9ydHMgPSB7XG4gIHNldHVwOiB0cml2aWFsRnVuY3Rpb24sXG4gIG9uTWVzc2FnZTogdHJpdmlhbEZ1bmN0aW9uLFxuICBjbGVhbnVwOiB0cml2aWFsRnVuY3Rpb24sXG59O1xuXG5jb25zdCBjbGllbnQgPSBjb25uZWN0KHNlcnZlciwgY3JlZGVudGlhbHMpO1xuXG5jb25zdCBzYWZlUHVibGlzaCA9IChtb2R1bGUsIHRvcGljLCBtZXNzYWdlLCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHQgPSBtb2R1bGUgKyAodG9waWMgPyAnLycgOiAnJyk7XG4gIGNvbnNvbGUubG9nKHQpO1xuICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgY2xpZW50LnB1Ymxpc2godCwgbWVzc2FnZSwgb3B0aW9ucyk7XG59O1xuXG4vLyBDYWxsIHNldHVwIGZvciBldmVyeSBtb2R1bGUgaW4gY29uZmlnLiBSZXR1cm5zIGFycmF5IG9mIGNsZWFudXAgZnVuY3Rpb25zLlxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuY29uc3Qgc3RhcnR1cCA9IGFzeW5jICgpID0+IHtcbiAgT2JqZWN0LmtleXMobW9kdWxlcykuZm9yRWFjaChhc3luYyAobmFtZSkgPT4ge1xuICAgIGNvbnN0IG0gPSBtb2R1bGVzW25hbWVdO1xuICAgIG0ubmFtZSA9IG5hbWU7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENhbm5vdCB1c2UgdGVtcGxhdGUgbGl0ZXJhbHMuIFBhdGggaGFzIHRvIGJlIGhhcmRjb2RlZC4gTW9kdWxlIG5hbWUgY2FuIGNoYW5nZVxuICAgICAgY29uc3QgeyBzZXR1cCwgb25NZXNzYWdlLCBjbGVhbnVwIH0gPSBPYmplY3QuYXNzaWduKFxuICAgICAgICBkZWZhdWx0RXhwb3J0cyxcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci10ZW1wbGF0ZVxuICAgICAgICBhd2FpdCBpbXBvcnQoJy4vbW9kdWxlcy8nICsgbS5uYW1lICsgJy5qcycpLFxuICAgICAgKTtcbiAgICAgIGxvZ2dlci5sb2coYExvYWRlZCBtb2R1bGU6ICR7bS5wcmV0dHlOYW1lfS5gKTtcbiAgICAgIHNldHVwKHsgcHVibGlzaEZ1bmN0aW9uOiBzYWZlUHVibGlzaC5iaW5kKG51bGwsIG0ubmFtZSksIC4uLm0uY29uZmlnIH0pO1xuICAgICAgbG9nZ2VyLmxvZyhgU2V0dXAgbW9kdWxlOiAke20ucHJldHR5TmFtZX0uYCk7XG4gICAgICBtb2R1bGVzW20ubmFtZV0ubG9hZGVkID0gdHJ1ZTtcbiAgICAgIG1vZHVsZXNbbS5uYW1lXS5jYWxsYmFja3MgPSB7IHNldHVwLCBvbk1lc3NhZ2UsIGNsZWFudXAgfTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIud2FybihgRmFpbGVkIHRvIGxvYWQgbW9kdWxlOiAke20ucHJldHR5TmFtZX0uYCk7XG4gICAgICBsb2dnZXIud2FybihlKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY2xpZW50Lm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICBsb2dnZXIubG9nKCdDb25uZWN0ZWQgdG8gTVFUVCBicm9rZXInKTtcbiAgc3RhcnR1cCgpLnRoZW4oKCkgPT4ge1xuICAgIE9iamVjdC5rZXlzKG1vZHVsZXMpLmZvckVhY2goKG5hbWUpID0+IHtcbiAgICAgIGNvbnN0IG0gPSBtb2R1bGVzW25hbWVdO1xuICAgICAgY2xpZW50LnN1YnNjcmliZShtLm5hbWUsIChlcnIpID0+IHtcbiAgICAgICAgaWYgKGVycikgbG9nZ2VyLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlKTtcbiAgICBjb25zb2xlLmxvZygnRXJyb3Igc2V0dGluZyB1cCBtb2R1bGVzLiBMaWtlbHkgbW9yZSBlcnJvciBvdXRwdXQgaXMgc2hvd24gYWJvdmUnKTtcbiAgfSk7XG59KTtcblxuY2xpZW50Lm9uKCdtZXNzYWdlJywgKHRvcGljLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnNvbGUubG9nKGBOZXcgbWVzc2FnZSBvbiB0b3BpYyAke3RvcGljfTogJHttZXNzYWdlLnRvU3RyaW5nKCl9YCk7XG59KTtcblxucHJvY2Vzcy5vbignZXhpdCcsIChjb2RlKSA9PiB7XG4gIGxvZ2dlci5sb2coYFdob2EhIEV4aXQgY29kZSAke2NvZGV9LCBjbGVhbmluZyB1cC4uLmApO1xuICBtb2R1bGVzLmZvckVhY2goKG0pID0+IHtcbiAgICBtLmNsZWFudXAoKTtcbiAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=